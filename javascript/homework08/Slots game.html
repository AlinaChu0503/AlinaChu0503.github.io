<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">

    <title>Slots game</title>
    <style>
        /* box-id的樣式 */
        [box-id]{
            width: 110px;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: none;
            transition: .3s;
        }

        /* 當格某個box被選到的時候 */
        [box-id].active{
            border: solid 5px red;
            box-shadow: 0 0 20px red;
            transition: 0s;
        }
        /* box-id以外的樣式 */
        i{
            font-size: 48px;
        }

        #msg{
            font-size: 36px;
            text-align: center;
        }
    </style>
  </head>
  <body>
    <div class="container">
        <div class="row">
          <div box-id ="1" class="col-1"></div>
          <div box-id ="2" class="col-1"></div>
          <div box-id ="3" class="col-1"></div>
          <div box-id ="4" class="col-1"></div>
          <div box-id ="5" class="col-1"></div>
          <div box-id ="6" class="col-1"></div>
          <div box-id ="7" class="col-1"></div>
          <div box-id ="8" class="col-1"></div>
          <div box-id ="9" class="col-1"></div>
          <div box-id ="10" class="col-1"></div>
          <div box-id ="11" class="col-1"></div>
          <div box-id ="12" class="col-1"></div>
        </div>
        <div class="row">
            <div box-id ="32" class="col-1"></div>
            <div class="col-10"></div>
            <div box-id ="13" class="col-1"></div>
        </div>
        <div class="row">
            <div box-id ="31" class="col-1"></div>
            <div class="col-10 m-auto">
                <p id="msg" class="m-0"></p>
            </div>
            <div box-id ="14" class="col-1"></div>
        </div>
        <div class="row">
            <div box-id ="30" class="col-1"></div>
            <div class="col-10"></div>
            <div box-id ="15" class="col-1"></div>
        </div>
        <div class="row">
            <div box-id ="29" class="col-1"></div>
            <div class="col-10"></div>
            <div box-id ="16" class="col-1"></div>
        </div>
        <div class="row">
            <div box-id ="28" class="col-1"></div>
            <div box-id ="27" class="col-1"></div>
            <div box-id ="26" class="col-1"></div>
            <div box-id ="25" class="col-1"></div>
            <div box-id ="24" class="col-1"></div>
            <div box-id ="23" class="col-1"></div>
            <div box-id ="22" class="col-1"></div>
            <div box-id ="21" class="col-1"></div>
            <div box-id ="20" class="col-1"></div>
            <div box-id ="19" class="col-1"></div>
            <div box-id ="18" class="col-1"></div>
            <div box-id ="17" class="col-1"></div>
        </div>

          <!-- button -->
        <div class="row">
              <div class="clo-12">
                  <button class="btn btn-primary w-100">Start</button>
              </div>
        </div>
    </div>    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <!-- <i class="fab fa-facebook-square"></i> -->
    <!-- <i class="fab fa-instagram-square"></i> -->
    <!-- <i class="fab fa-line"></i> -->

    <script>
        let brickData = [
            {
                id: '1',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '2',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '3',
                color: 'green',
                icon: 'fab fa-line',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '4',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '5',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '6',
                color: 'green',
                icon: 'fab fa-line',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '7',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '8',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '9',
                color: 'green',
                icon: 'fab fa-line',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '10',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '11',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '12',
                color: 'green',
                icon: 'fab fa-line',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '13',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '14',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '15',
                color: 'green',
                icon: 'fab fa-line',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '16',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '17',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '18',
                color: 'green',
                icon: 'fab fa-line',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '19',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '20',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '21',
                color: 'green',
                icon: 'fab fa-line',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '22',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '23',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '24',
                color: 'green',
                icon: 'fab fa-line',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '25',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '26',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '27',
                color: 'green',
                icon: 'fab fa-line',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '28',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '29',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '30',
                color: 'green',
                icon: 'fab fa-line',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '31',
                color: 'red',
                icon: 'fab fa-instagram-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            {
                id: '32',
                color: 'blue',
                icon: 'fab fa-facebook-square',
                traget: function(){
                    return this.icon.split('-')[1];
                }
            },
            
        ];
        let steps = 0; //剩餘的步數
        let allSteps = 0; //全部的步數
        let current = 0; //目前走到哪一格
        let speed; //速率(越大代表越慢)
        //渲染畫面
        let bricks = document.querySelectorAll('[box-id]');
        bricks = Array.from(bricks).sort((a,b)=>{
            return a.getAttributeNode('box-id').value - b.getAttributeNode('box-id').value;
        });
        bricks.forEach((x, index) =>{
            let id = index + 1;
            let data = brickData.find(x => x.id == id);
            let icon = document.createElement('i');
            icon.setAttribute('class', data.icon);
            icon.style.color = data.color;
            x.appendChild(icon);
        });

        //Start Button
        document.querySelector('button').addEventListener('click', function(){
            speed = 50;
            //至少要走一步
            let random = Math.floor(Math.random() * brickData.length) + 1;
            // 先空轉三圈，再隨機加步數
            steps = random + (3 * brickData.length);
            allSteps = steps;
            turnAround();
        });

        function turnAround(){
            bricks[current].classList.remove('active');
            current++;

            if(current >= bricks.length) current = 0;

            bricks[current].classList.add('active');
            steps--;

            // if(steps >0){
            //     setTimeout(turnAround, speed);
            // } else{
            //     //跑完了
            //     // Console.log(`跑完了 ${brickData[current].target()}`)
            //     let msgBox = document.querySelector('#msg');
            //     let val = brickData[current].target();
            //     msgBox.innerText = `接下來30分鐘 -> ${val}`;
            // }

            //變速版本
            if (steps > 0) {
                setTimeout(turnAround, speed);

                if(steps < Math.floor((allSteps / 3))) speed +=7;
            }
            else{
                let msgBox = document.querySelector('#msg');
                let val = brickData[current].target();
                msgBox.innerText = `接下來30分鐘 -> ${val}`;
            }
        }
    </script>

    
  </body>
</html>